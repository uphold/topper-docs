---
sidebar_position: 1
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';


# Crypto on-ramp

The crypto on-ramp flow allows a user to add funds from a credit or debit card to a crypto address.

## Bootstrap token payload

<Tabs>
  <TabItem label="Schema" value="schema" default>

- `source` (_optional_): An object configuring the asset and amount to be paid.
  - `amount` (_optional_): Amount to be paid.
  - `asset`: Currency code in the [ISO 4217](https://www.iso.org/iso-4217-currency-codes.html) format used to make the payment.
- `target` (_optional_): An object configuring recipient wallet.
  - `amount` (_optional_): Amount the user will receive.
  - `asset`: Cryptoasset the user will receive.
  - `network`: Network of the receiving asset.
  - `address`: Recipient wallet address.
  - `tag` (_optional_): Tag of the crypto transaction, used to complement the `address`.
    - `type`: Tag type (e.g.: `memo` or `destination-tag`).
    - `value`: Tag value.
  - `priority` (_optional_): Priority of the crypto transaction (e.g.: `fast` will enable instant send for `Dash` transactions). Defaults to `normal`.
  - `recipientEditMode` (_optional_): Controls if the user can change `asset`, `network`, `address` and `tag` on the widget. Defaults to `not-editable`.

:::note
At least one of `source.amount` or `target.amount` _must_ be provided, but not both.

The supported values for `source.asset`, `target.asset`, `target.network`, `target.tag` and `target.priority` can be found using our [REST API](../rest-api.md), via the [assets endpoint](https://api.topperpay.com/assets/crypto-onramp).
:::

:::caution
In the `sandbox` environment, Topper has limited funds on testnets. If you make an order using an asset we have no funds for, the order will be stuck indefinitely trying to create the blockchain transaction.
We recommend that you use `XRP` for testing purposes when integrating Topper since we have a larger quantity of them. If you prefer to test with another asset and network, please reach out to us beforehand so that we can guarantee funds on our pool and give you a smoother integration experience.
:::

  </TabItem>
  <TabItem label="Example" value="example">

```json
{
  "iat": 1679538023,
  "jti": "4b552af1-1592-42f8-bbc9-dac28e2b4000",
  "sub": "b9fe022b-f436-49e1-bb89-6f2e8eabf336",
  // highlight-start
  "target": {
    "asset": "ETH",
    "network": "ethereum",
    "address": "0xb794f5ea0ba39494ce839613fffba74279579268",
    "label": "My wallet"
  }
  // highlight-end
}
```

  </TabItem>
</Tabs>

### Recipient edit mode

<Tabs>
  <TabItem label="Not editable" value="not-editable" default>

When `recipientEditMode` is `not-editable`, the user can can't change `asset`, `network`, `address` or `tag` on the widget. This means that these fields are all required on the bootstrap token.

```json
{
  "iat": 1679538023,
  "jti": "4b552af1-1592-42f8-bbc9-dac28e2b4000",
  "sub": "b9fe022b-f436-49e1-bb89-6f2e8eabf336",
  // highlight-start
  "target": {
    "asset": "ETH",
    "network": "ethereum",
    "address": "0xb794f5ea0ba39494ce839613fffba74279579268",
    "label": "My wallet",
    "recipientEditMode": "not-editable"
  }
  // highlight-end
}
```

  </TabItem>
  <TabItem label="Only address and tag" value="only-address-and-tag" default>

When `recipientEditMode` is `address-and-tag`, the user can only change `address` and `tag` on the widget. This means that these fields are optional on the bootstrap token but you can still provide values for them. On the other hand, `asset` and `network` become mandatory.

```json
{
  "iat": 1679538023,
  "jti": "4b552af1-1592-42f8-bbc9-dac28e2b4000",
  "sub": "b9fe022b-f436-49e1-bb89-6f2e8eabf336",
  // highlight-start
  "target": {
    "asset": "ETH",
    "network": "ethereum",
    "recipientEditMode": "only-address-and-tag"
  }
  // highlight-end
}
```

  </TabItem>
  <TabItem label="All editable" value="all-editable" default>

When `recipientEditMode` is `all-editable`, the user can change `asset`, `network`, `address` and `tag` on the widget. This means that all these fields are optional on the bootstrap token but you can still provide values for them.

```json
{
  "iat": 1679538023,
  "jti": "4b552af1-1592-42f8-bbc9-dac28e2b4000",
  "sub": "b9fe022b-f436-49e1-bb89-6f2e8eabf336",
  // highlight-start
  "target": {
    "recipientEditMode": "all-editable"
  }
  // highlight-end
}
```

  </TabItem>
</Tabs>

## Events

### `order:crypto-onramp:charged`

Triggered when a user has been charged.

<Tabs>
  <TabItem label="Schema" value="schema" default>

- `id`: UUID of the order.
- `status`: Status of the order (`processing`).
- `createdAt`: Timestamp at which the order was created.
- `updatedAt`: Timestamp at which the order was last updated.
- `origin`: Object containing information about how the user paid.
  - `amount`: Amount the user paid.
  - `rate`: Rate used to calculate the amount.
  - `asset`: Currency code in the [ISO 4217](https://www.iso.org/iso-4217-currency-codes.html) format used to make the payment.
  - `paymentMethod`: Object containing information about the payment method used.
    - `type`: Type of payment method.
- `destination`: Object containing information about what the user will receive.
  - `amount`: Amount the user will receive.
  - `rate`: Rate used to calculate the amount.
  - `asset`: Cryptoasset the user will receive.
  - `network`: Network of the receiving asset.
  - `address`: Recipient wallet address.
  - `tag` (_optional_): Tag of the crypto transaction, used to complement the `address`.
    - `type`: Tag type (e.g.: `memo` or `destination-tag`).
    - `value`: Tag value.
  - `priority` (_optional_): Priority of the crypto transaction.
- `fees`: Array containing fees associated with the order.
  - `amount`: Amount user was charged for this fee.
  - `asset`: Asset used to charge the fee.
  - `type`: Type of fee (`network` or `deposit`).
- `widget`: Widget associated with the session.
  - `id` UUID of the widget.
  - `name`: Name of the widget.
  - `flow`: Flow associated with the widget.

:::note
The values for `origin.paymentMethod.type` can be found using our [REST API](../rest-api.md), via the [payment methods endpoint](https://api.topperpay.com/payment-methods/crypto-onramp).
:::

  </TabItem>
  <TabItem label="Example" value="example">

```json
{
  "name": "order:crypto-onramp:charged",
  "id": "00a991cf-a870-43af-88b8-43c51532831d",
  "bootstrapTokenId": "141bfa06-481e-4684-96eb-cec4ad529616",
  "data": {
    // highlight-start
    "id": "966b8e24-6a65-442a-942e-577f16288789",
    "status": "processing",
    "createdAt": "2023-06-12T17:21:21.240Z",
    "updatedAt": "2023-06-12T17:21:21.240Z",
    "origin": {
      "amount": "100.00",
      "rate": "1770.27534301775263314892",
      "asset": "USD",
      "paymentMethod": {
        "type": "credit-card"
      }
    },
    "destination": {
      "amount": "0.047116964221968237",
      "rate": "0.00056488387749632223",
      "asset": "ETH",
      "network": "ethereum",
      "address": "0xb794F5eA0ba39494cE839613fffBA74279579268"
    },
    "fees": [
      {
        "amount": "14.17",
        "asset": "USD",
        "type": "network"
      },
      {
        "amount": "2.42",
        "asset": "USD",
        "type": "deposit"
      }
    ],
    "widget": {
      "id": "998544f2-5b01-4062-9394-22827ff5db6c",
      "name": "ACME",
      "flow": "crypto_onramp"
    }
    // highlight-end
  }
}
```

  </TabItem>
</Tabs>

### `order:crypto-onramp:completed`

Triggered when a user's order has completed.

<Tabs>
  <TabItem label="Schema" value="schema" default>

- `id`: UUID of the order.
- `status`: Status of the order (`completed`).
- `createdAt`: Timestamp at which the order was created.
- `updatedAt`: Timestamp at which the order was last updated.
- `origin`: Object containing information about how the user paid.
  - `amount`: Amount the user paid.
  - `rate`: Rate used to calculate the amount.
  - `asset`: Currency code in the [ISO 4217](https://www.iso.org/iso-4217-currency-codes.html) format used to make the payment.
  - `paymentMethod`: Object containing information about the payment method used.
    - `type`: Type of payment method.
- `destination`: Object containing information about what the user received.
  - `amount`: Amount the user received.
  - `rate`: Rate used to calculate the amount.
  - `asset`: Cryptoasset the user received.
  - `network`: Network of the receiving asset.
  - `address`: Recipient wallet address.
  - `tag` (_optional_): Tag of the crypto transaction, used to complement the `address`.
    - `type`: Tag type (e.g.: `memo` or `destination-tag`).
    - `value`: Tag value.
  - `priority` (_optional_): Priority of the crypto transaction.
  - `ledger` (_optional_): Object containing information about the transaction on the ledger.
    - `txid`: Transaction ID on the ledger.
- `fees`: Array containing fees associated with the order.
  - `amount`: Amount user was charged for this fee.
  - `asset`: Asset used to charge the fee.
  - `type`: Type of fee (`network` or `deposit`).
- `widget`: Widget associated with the session.
  - `id` UUID of the widget.
  - `name`: Name of the widget.
  - `flow`: Flow associated with the widget.

:::note
The values for `origin.paymentMethod.type` can be found using our [REST API](../rest-api.md), via the [payment methods endpoint](https://api.topperpay.com/payment-methods/crypto-onramp).
:::

  </TabItem>
  <TabItem label="Example" value="example">

```json
{
  "name": "order:crypto-onramp:completed",
  "id": "00a991cf-a870-43af-88b8-43c51532831d",
  "bootstrapTokenId": "141bfa06-481e-4684-96eb-cec4ad529616",
  "data": {
    // highlight-start
    "id": "966b8e24-6a65-442a-942e-577f16288789",
    "status": "completed",
    "createdAt": "2023-06-12T17:21:21.240Z",
    "updatedAt": "2023-06-12T17:21:21.240Z",
    "origin": {
      "amount": "100.00",
      "rate": "1770.27534301775263314892",
      "asset": "USD",
      "paymentMethod": {
        "type": "credit-card"
      }
    },
    "destination": {
      "amount": "0.047116964221968237",
      "rate": "0.00056488387749632223",
      "asset": "ETH",
      "ledger": {
        "txid": "0xdfa1ea4ddb841af466a5ca78c6e1f0edfaef5e54e79a28238d2a5bb2da4f1911"
      },
      "network": "ethereum",
      "address": "0xb794F5eA0ba39494cE839613fffBA74279579268"
    },
    "fees": [
      {
        "amount": "14.17",
        "asset": "USD",
        "type": "network"
      },
      {
        "amount": "2.42",
        "asset": "USD",
        "type": "deposit"
      }
    ],
    "widget": {
      "id": "998544f2-5b01-4062-9394-22827ff5db6c",
      "name": "ACME",
      "flow": "crypto_onramp"
    }
    // highlight-end
  }
}
```

  </TabItem>
</Tabs>

### `order:crypto-onramp:failed`

Triggered when a user's order has failed.

<Tabs>
  <TabItem label="Schema" value="schema" default>

- `id`: UUID of the order.
- `status`: Status of the order (`failed`).
- `createdAt`: Timestamp at which the order was created.
- `updatedAt`: Timestamp at which the order was last updated.
- `origin`: Object containing information about how the user paid.
  - `amount`: Amount the user paid.
  - `rate`: Rate used to calculate the amount.
  - `asset`: Currency code in the [ISO 4217](https://www.iso.org/iso-4217-currency-codes.html) format used to make the payment.
  - `paymentMethod`: Object containing information about the payment method used.
    - `type`: Type of payment method.
- `destination`: Object containing information about what the user would have received.
  - `amount`: Amount the user would have received.
  - `rate`: Rate used to calculate the amount.
  - `asset`: Cryptoasset the user would have received.
  - `network`: Network of the receiving asset.
  - `address`: Recipient wallet address.
  - `tag` (_optional_): Tag of the crypto transaction, used to completement the `address`.
    - `type`: Tag type (e.g.: `memo` or `destination-tag`).
    - `value`: Tag value.
  - `priority` (_optional_): Priority of the crypto transaction.
- `fees`: Array containing fees associated with the order.
  - `amount`: Amount user was charged for this fee.
  - `asset`: Asset used to charge the fee.
  - `type`: Type of fee (`network` or `deposit`).
- `widget`: Widget associated with the session.
  - `id` UUID of the widget.
  - `name`: Name of the widget.
  - `flow`: Flow associated with the widget.

:::note
The values for `origin.paymentMethod.type` can be found using our [REST API](../rest-api.md), via the [payment methods endpoint](https://api.topperpay.com/payment-methods/crypto-onramp).
:::

  </TabItem>
  <TabItem label="Example" value="example">

```json
{
  "name": "order:crypto-onramp:failed",
  "id": "00a991cf-a870-43af-88b8-43c51532831d",
  "bootstrapTokenId": "141bfa06-481e-4684-96eb-cec4ad529616",
  "data": {
    // highlight-start
    "id": "966b8e24-6a65-442a-942e-577f16288789",
    "status": "failed",
    "createdAt": "2023-06-12T17:21:21.240Z",
    "updatedAt": "2023-06-12T17:21:21.240Z",
    "origin": {
      "amount": "100.00",
      "rate": "1770.27534301775263314892",
      "asset": "USD",
      "paymentMethod": {
        "type": "credit-card"
      }
    },
    "destination": {
      "amount": "0.047116964221968237",
      "rate": "0.00056488387749632223",
      "asset": "ETH",
      "network": "ethereum",
      "address": "0xb794F5eA0ba39494cE839613fffBA74279579268"
    },
    "fees": [
      {
        "amount": "14.17",
        "asset": "USD",
        "type": "network"
      },
      {
        "amount": "2.42",
        "asset": "USD",
        "type": "deposit"
      }
    ],
    "widget": {
      "id": "998544f2-5b01-4062-9394-22827ff5db6c",
      "name": "ACME",
      "flow": "crypto_onramp"
    }
    // highlight-end
  }
}
```

  </TabItem>
</Tabs>
